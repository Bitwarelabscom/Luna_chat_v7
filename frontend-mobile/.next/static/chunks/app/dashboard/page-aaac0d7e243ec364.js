(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{5339:function(e,t,a){Promise.resolve().then(a.bind(a,4977))},4977:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return er}});var s=a(7437),i=a(2265),n=a(3011);let r="luna_access_token",l="luna_refresh_token",c={getAccessToken:()=>localStorage.getItem(r),getRefreshToken:()=>localStorage.getItem(l),setTokens:(e,t)=>{localStorage.setItem(r,e),localStorage.setItem(l,t)},clearTokens:()=>{localStorage.removeItem(r),localStorage.removeItem(l)}};class d extends Error{constructor(e,t){super(t),this.status=e,this.name="ApiError"}}async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{method:a="GET",body:s,headers:i={},skipAuth:n=!1}=t;if(s&&(i["Content-Type"]="application/json"),!n){let e=c.getAccessToken();e&&(i.Authorization="Bearer ".concat(e))}let r=await fetch("".concat("").concat("").concat(e),{method:a,headers:i,body:s?JSON.stringify(s):void 0});if(401===r.status&&!n){let t=c.getRefreshToken();if(t){let n=await fetch("".concat("").concat("","/api/auth/refresh"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});if(n.ok){let t=await n.json();c.setTokens(t.accessToken,t.refreshToken),i.Authorization="Bearer ".concat(t.accessToken),r=await fetch("".concat("").concat("").concat(e),{method:a,headers:i,body:s?JSON.stringify(s):void 0})}else c.clearTokens()}}if(!r.ok){let e=await r.json().catch(()=>({error:"Request failed"}));throw new d(r.status,e.error||"Request failed")}return 204===r.status?{}:r.json()}let m={autoLogin:async()=>{let e=await o("/api/auth/auto-login",{method:"POST",skipAuth:!0});return c.setTokens(e.accessToken,e.refreshToken),{user:e.user}},logout:async()=>{try{await o("/api/auth/logout",{method:"POST"})}finally{c.clearTokens()}return{success:!0}},me:()=>o("/api/auth/me")},x={getSessions:e=>{let t=new URLSearchParams;(null==e?void 0:e.limit)&&t.set("limit",e.limit.toString()),(null==e?void 0:e.offset)&&t.set("offset",e.offset.toString()),(null==e?void 0:e.archived)&&t.set("archived","true");let a=t.toString();return o("/api/chat/sessions".concat(a?"?".concat(a):""))},getSession:e=>o("/api/chat/sessions/".concat(e)),createSession:e=>o("/api/chat/sessions",{method:"POST",body:e||{}})};async function*u(e,t){var a;let s={"Content-Type":"application/json"},i=c.getAccessToken();i&&(s.Authorization="Bearer ".concat(i));let n=await fetch("".concat("").concat("","/api/chat/sessions/").concat(e,"/send"),{method:"POST",headers:s,body:JSON.stringify({message:t,stream:!0})});if(!n.ok)throw new d(n.status,"Failed to send message");let r=null===(a=n.body)||void 0===a?void 0:a.getReader();if(!r)throw Error("No response body");let l=new TextDecoder,o="";for(;;){let{done:e,value:t}=await r.read();if(e)break;let a=(o+=l.decode(t,{stream:!0})).split("\n");for(let e of(o=a.pop()||"",a))if(e.startsWith("data: ")){let t=e.slice(6);if("[DONE]"===t)return;try{let e=JSON.parse(t);yield e}catch(e){}}}}let v={getSettings:()=>o("/api/trading/settings"),updateSettings:e=>o("/api/trading/settings",{method:"PUT",body:e}),getPortfolio:()=>o("/api/trading/portfolio"),getStats:e=>o("/api/trading/stats".concat(e?"?days=".concat(e):"")),getActiveTrades:()=>o("/api/trading/active"),stopTrade:(e,t)=>o("/api/trading/trades/".concat(e,"/stop"),{method:"POST",body:{skipConfirmation:t||!1}}),getBots:()=>o("/api/trading/bots"),updateBotStatus:(e,t)=>o("/api/trading/bots/".concat(e,"/status"),{method:"PATCH",body:{status:t}}),createChatSession:()=>o("/api/trading/chat/session",{method:"POST"}),getChatMessages:e=>o("/api/trading/chat/session/".concat(e,"/messages")),sendChatMessage:(e,t)=>o("/api/trading/chat/session/".concat(e,"/send"),{method:"POST",body:{message:t}}),getResearchSignals:e=>o("/api/trading/research/signals".concat(e?"?limit=".concat(e):"")),confirmSignal:(e,t)=>o("/api/trading/research/confirm/".concat(e),{method:"POST",body:{action:t}}),getAutoSettings:()=>o("/api/trading/auto/settings"),updateAutoSettings:e=>o("/api/trading/auto/settings",{method:"PUT",body:e}),startAutoTrading:()=>o("/api/trading/auto/start",{method:"POST"}),stopAutoTrading:()=>o("/api/trading/auto/stop",{method:"POST"}),getAutoState:()=>o("/api/trading/auto/state"),getAutoHistory:()=>o("/api/trading/auto/history"),getSignalHistory:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return o("/api/trading/auto/signals?limit=".concat(e))},getTopCandidates:()=>o("/api/trading/auto/candidates"),getStrategies:()=>o("/api/trading/auto/strategies"),getMarketRegime:()=>o("/api/trading/auto/regime")},h=(0,n.U)(e=>({user:null,isAuthenticated:!1,isLoading:!0,login:async()=>{let{user:t}=await m.autoLogin();e({user:t,isAuthenticated:!0,isLoading:!1})},logout:async()=>{try{await m.logout()}catch(e){}e({user:null,isAuthenticated:!1})},checkAuth:async()=>{try{let t=await m.me();e({user:t,isAuthenticated:!0,isLoading:!1})}catch(t){try{let{user:t}=await m.autoLogin();e({user:t,isAuthenticated:!0,isLoading:!1})}catch(t){e({user:null,isAuthenticated:!1,isLoading:!1})}}}})),g=(0,n.U)((e,t)=>({sessions:[],currentSession:null,isLoadingSessions:!1,isLoadingMessages:!1,isSending:!1,streamingContent:"",statusMessage:"",loadSessions:async()=>{e({isLoadingSessions:!0});try{let{sessions:t}=await x.getSessions({limit:50});e({sessions:t})}finally{e({isLoadingSessions:!1})}},loadSession:async t=>{e({isLoadingMessages:!0,streamingContent:""});try{let a=await x.getSession(t);e({currentSession:a})}finally{e({isLoadingMessages:!1})}},createSession:async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"assistant",a=await x.createSession({mode:t});return e(e=>({sessions:[a,...e.sessions]})),a},addUserMessage:a=>{var s;let i={id:"temp-".concat(Date.now()),sessionId:(null===(s=t().currentSession)||void 0===s?void 0:s.id)||"",role:"user",content:a,tokensUsed:0,createdAt:new Date().toISOString()};e(e=>({currentSession:e.currentSession?{...e.currentSession,messages:[...e.currentSession.messages,i]}:null}))},addAssistantMessage:(a,s,i)=>{var n;let r={id:s,sessionId:(null===(n=t().currentSession)||void 0===n?void 0:n.id)||"",role:"assistant",content:a,tokensUsed:(null==i?void 0:i.promptTokens)&&(null==i?void 0:i.completionTokens)?i.promptTokens+i.completionTokens:0,createdAt:new Date().toISOString(),metrics:i};e(e=>({currentSession:e.currentSession?{...e.currentSession,messages:[...e.currentSession.messages,r]}:null,streamingContent:""}))},setStreamingContent:t=>e({streamingContent:t}),appendStreamingContent:t=>e(e=>({streamingContent:e.streamingContent+t})),setIsSending:t=>e({isSending:t}),setStatusMessage:t=>e({statusMessage:t}),clearCurrentSession:()=>e({currentSession:null,streamingContent:"",statusMessage:""})}));var p=a(5466),b=a(3417),j=a(525),f=a(8728),N=a(1994);let y=[{id:"overview",label:"Overview",icon:p.Z},{id:"chat",label:"Chat",icon:b.Z},{id:"trading",label:"Trading",icon:j.Z},{id:"settings",label:"Settings",icon:f.Z}];function w(e){let{activeTab:t,onTabChange:a}=e;return(0,s.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 bg-[var(--terminal-surface)] border-t border-[var(--terminal-border)] z-50",children:(0,s.jsx)("div",{className:"flex items-stretch justify-around",style:{paddingBottom:"env(safe-area-inset-bottom)"},children:y.map(e=>{let i=e.icon,n=t===e.id;return(0,s.jsxs)("button",{onClick:()=>a(e.id),className:(0,N.Z)("flex-1 flex flex-col items-center justify-center py-3 gap-1 transition-colors min-h-[64px]",n?"text-[var(--terminal-accent)]":"text-[var(--terminal-text-muted)]"),children:[(0,s.jsx)(i,{size:22,strokeWidth:n?2.5:2}),(0,s.jsx)("span",{className:"text-[10px] font-medium uppercase tracking-wider",children:e.label}),n&&(0,s.jsx)("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-8 h-0.5 bg-[var(--terminal-accent)] rounded-full"})]},e.id)})})})}var S=a(3085),k=a(5252),T=a(4401),C=a(6215),P=a(1723);let F=[];function A(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{symbols:t,onPriceUpdate:a,enabled:s=!0}=e,n=(t||F).sort().join(","),r=(0,i.useMemo)(()=>t||F,[n]),[l,c]=(0,i.useState)(new Map),[d,o]=(0,i.useState)(!1),[m,x]=(0,i.useState)(null),u=(0,i.useRef)(null),v=(0,i.useRef)(null),h=(0,i.useRef)(null),g=(0,i.useRef)(a);g.current=a;let p=(0,i.useRef)(r);p.current=r;let b=(0,i.useCallback)(()=>{var e,t;let a;if(!s||(null===(e=u.current)||void 0===e?void 0:e.readyState)===WebSocket.OPEN||(null===(t=u.current)||void 0===t?void 0:t.readyState)===WebSocket.CONNECTING)return;let i="https:"===window.location.protocol?"wss:":"ws:";a="".concat(i,"//").concat(window.location.host,"/ws/trading");try{let e=new WebSocket(a);u.current=e,e.onopen=()=>{o(!0),x(null);let t=p.current;t.length>0&&e.send(JSON.stringify({type:"subscribe",symbols:t})),h.current=setInterval(()=>{e.readyState===WebSocket.OPEN&&e.send(JSON.stringify({type:"ping"}))},3e4)},e.onmessage=e=>{try{let t=JSON.parse(e.data);("price_update"===t.type||"initial_prices"===t.type)&&t.data&&Array.isArray(t.data)&&(c(e=>{let a=new Map(e);for(let e of t.data)a.set(e.symbol,e);return a}),g.current&&g.current(t.data))}catch(e){console.error("Failed to parse WebSocket message:",e)}},e.onclose=()=>{o(!1),u.current=null,h.current&&(clearInterval(h.current),h.current=null),s&&(v.current=setTimeout(()=>{b()},5e3))},e.onerror=e=>{console.error("WebSocket error:",e),x("WebSocket connection error")}}catch(e){x(e.message)}},[s]);(0,i.useEffect)(()=>(b(),()=>{v.current&&clearTimeout(v.current),h.current&&clearInterval(h.current),u.current&&u.current.close()}),[b]),(0,i.useEffect)(()=>{var e;(null===(e=u.current)||void 0===e?void 0:e.readyState)===WebSocket.OPEN&&r.length>0&&u.current.send(JSON.stringify({type:"subscribe",symbols:r}))},[r]);let j=(0,i.useCallback)(e=>l.get(e),[l]),f=(0,i.useCallback)(()=>Array.from(l.values()),[l]);return{prices:l,connected:d,error:m,getPrice:j,getAllPrices:f}}function M(e){let{label:t,value:a,subValue:i,trend:n,icon:r}=e;return(0,s.jsxs)("div",{className:"card p-4",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,s.jsx)("span",{className:"text-[var(--terminal-text-muted)] text-xs uppercase tracking-wider",children:t}),(0,s.jsx)("span",{className:"text-[var(--terminal-text-dim)]",children:r})]}),(0,s.jsx)("div",{className:"text-xl font-semibold text-[var(--terminal-text)]",children:a}),i&&(0,s.jsxs)("div",{className:"text-sm mt-1 ".concat("up"===n?"pnl-positive":"down"===n?"pnl-negative":"text-[var(--terminal-text-muted)]"),children:["up"===n&&(0,s.jsx)(j.Z,{size:12,className:"inline mr-1"}),"down"===n&&(0,s.jsx)(S.Z,{size:12,className:"inline mr-1"}),i]})]})}function R(e){let{symbol:t,side:a,pnl:i,pnlPercent:n,currentPrice:r}=e,l=i>=0;return(0,s.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-[var(--terminal-border)] last:border-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"px-2 py-0.5 rounded text-xs font-medium ".concat("buy"===a?"bg-[rgba(0,214,143,0.15)] text-[var(--terminal-positive)]":"bg-[rgba(255,107,107,0.15)] text-[var(--terminal-negative)]"),children:a.toUpperCase()}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-[var(--terminal-text)]",children:t}),r&&(0,s.jsxs)("div",{className:"text-xs text-[var(--terminal-text-muted)]",children:["$",r.toFixed(2)]})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("div",{className:"font-medium ".concat(l?"pnl-positive":"pnl-negative"),children:[l?"+":"",i.toFixed(2)]}),(0,s.jsxs)("div",{className:"text-xs ".concat(l?"pnl-positive":"pnl-negative"),children:[l?"+":"",n.toFixed(2),"%"]})]})]})}function L(){var e,t,a;let[n,r]=(0,i.useState)(null),[l,c]=(0,i.useState)(null),[d,o]=(0,i.useState)(null),[m,x]=(0,i.useState)(!0),u=(null==d?void 0:null===(e=d.openPositions)||void 0===e?void 0:e.map(e=>e.symbol))||[],{prices:h,connected:g}=A({symbols:u,enabled:u.length>0});if((0,i.useEffect)(()=>{async function e(){try{let[e,t,a]=await Promise.all([v.getPortfolio().catch(()=>null),v.getStats(7).catch(()=>null),v.getActiveTrades().catch(()=>null)]);r(e),c(t),o(a)}catch(e){console.error("Failed to load overview data:",e)}finally{x(!1)}}e();let t=setInterval(e,3e4);return()=>clearInterval(t)},[]),m)return(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"w-8 h-8 border-2 border-[var(--terminal-accent)] border-t-transparent rounded-full animate-spin"})});let p=(null==n?void 0:n.totalValueUsdt)||0,b=(null==n?void 0:n.dailyPnl)||0,j=(null==n?void 0:n.dailyPnlPct)||0,f=(null==d?void 0:null===(t=d.openPositions)||void 0===t?void 0:t.length)||0,N=(null==l?void 0:l.winRate)||0;return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"status-dot ".concat(g?"status-live":"status-offline")}),(0,s.jsx)("span",{className:"text-xs text-[var(--terminal-text-muted)] uppercase tracking-wider",children:g?"Live":"Offline"})]}),(0,s.jsxs)("span",{className:"text-xs text-[var(--terminal-text-dim)]",children:["Last update: ",new Date().toLocaleTimeString()]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsx)(M,{label:"Portfolio",value:"$".concat(p.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})),subValue:"".concat(b>=0?"+":"","$").concat(b.toFixed(2)," (").concat(j.toFixed(2),"%)"),trend:b>=0?"up":"down",icon:(0,s.jsx)(k.Z,{size:18})}),(0,s.jsx)(M,{label:"Open Positions",value:f.toString(),subValue:f>0?"Active trades":"No positions",icon:(0,s.jsx)(T.Z,{size:18})}),(0,s.jsx)(M,{label:"Win Rate (7d)",value:"".concat(N.toFixed(1),"%"),subValue:"".concat((null==l?void 0:l.totalTrades)||0," trades"),icon:(0,s.jsx)(C.Z,{size:18})}),(0,s.jsx)(M,{label:"Today P&L",value:"".concat(b>=0?"+":"","$").concat(b.toFixed(2)),subValue:"".concat(j>=0?"+":"").concat(j.toFixed(2),"%"),trend:b>=0?"up":"down",icon:(0,s.jsx)(P.Z,{size:18})})]}),f>0&&(0,s.jsxs)("div",{className:"card",children:[(0,s.jsxs)("div",{className:"card-header flex items-center justify-between",children:[(0,s.jsx)("span",{children:"Active Positions"}),(0,s.jsx)("span",{className:"text-[var(--terminal-accent)]",children:f})]}),(0,s.jsx)("div",{className:"p-4",children:null==d?void 0:null===(a=d.openPositions)||void 0===a?void 0:a.map(e=>{let t=h.get(e.symbol);return(0,s.jsx)(R,{symbol:e.symbol,side:e.side,pnl:e.pnlDollar,pnlPercent:e.pnlPercent,currentPrice:(null==t?void 0:t.price)||e.currentPrice},e.id)})})]}),(null==n?void 0:n.holdings)&&n.holdings.length>0&&(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("div",{className:"card-header",children:"Holdings"}),(0,s.jsx)("div",{className:"p-4 space-y-3",children:n.holdings.slice(0,5).map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-[var(--terminal-surface-hover)] flex items-center justify-center text-xs font-bold",children:e.asset.slice(0,2)}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-[var(--terminal-text)]",children:e.asset}),(0,s.jsx)("div",{className:"text-xs text-[var(--terminal-text-muted)]",children:e.amount.toFixed(4)})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("div",{className:"font-medium text-[var(--terminal-text)]",children:["$",e.valueUsdt.toFixed(2)]}),(0,s.jsxs)("div",{className:"text-xs ".concat(e.priceChange24h>=0?"pnl-positive":"pnl-negative"),children:[e.priceChange24h>=0?"+":"",e.priceChange24h.toFixed(2),"%"]})]})]},e.symbol))})]})]})}var E=a(407),O=a(9397),D=a(4743),I=a(6202);function z(){let{sessions:e,currentSession:t,isLoadingSessions:a,isSending:n,streamingContent:r,statusMessage:l,loadSessions:c,loadSession:d,createSession:o,addUserMessage:m,addAssistantMessage:x,setStreamingContent:v,appendStreamingContent:h,setIsSending:p,setStatusMessage:b}=g(),[j,f]=(0,i.useState)(""),[N,y]=(0,i.useState)(!1),w=(0,i.useRef)(null),S=(0,i.useRef)(null);(0,i.useEffect)(()=>{c()},[c]),(0,i.useEffect)(()=>{var e;null===(e=w.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[null==t?void 0:t.messages,r]);let k=async()=>{if(!j.trim()||n)return;let e=j.trim();f("");let a=null==t?void 0:t.id;a||(a=(await o("companion")).id,await d(a)),m(e),p(!0),v(""),b("");try{let t="",s="";for await(let i of u(a,e))"content"===i.type&&i.content?(t+=i.content,h(i.content)):"status"===i.type&&i.status?b(i.status):"done"===i.type&&i.messageId&&(s=i.messageId,x(t,s,i.metrics))}catch(e){console.error("Failed to send message:",e),b("Failed to send message")}finally{p(!1),v("")}},T=async()=>{let e=await o("companion");await d(e.id),y(!1)},C=async e=>{await d(e),y(!1)};return(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--terminal-border)]",children:[(0,s.jsxs)("button",{onClick:()=>y(!N),className:"flex items-center gap-2 text-[var(--terminal-text)]",children:[(0,s.jsx)("span",{className:"font-medium truncate max-w-[200px]",children:(null==t?void 0:t.title)||"New Chat"}),(0,s.jsx)(E.Z,{size:16,className:"transition-transform ".concat(N?"rotate-90":"")})]}),(0,s.jsx)("button",{onClick:T,className:"p-2 text-[var(--terminal-accent)] hover:bg-[var(--terminal-surface-hover)] rounded-lg",children:(0,s.jsx)(O.Z,{size:20})})]}),N&&(0,s.jsx)("div",{className:"absolute inset-x-0 top-[52px] bottom-0 bg-[var(--terminal-bg)] z-40 overflow-y-auto",children:(0,s.jsx)("div",{className:"p-4 space-y-2",children:a?(0,s.jsx)("div",{className:"text-center py-8 text-[var(--terminal-text-muted)]",children:"Loading..."}):0===e.length?(0,s.jsx)("div",{className:"text-center py-8 text-[var(--terminal-text-muted)]",children:"No conversations yet"}):e.map(e=>(0,s.jsxs)("button",{onClick:()=>C(e.id),className:"w-full text-left p-3 rounded-lg transition-colors ".concat((null==t?void 0:t.id)===e.id?"bg-[var(--terminal-accent)] text-black":"bg-[var(--terminal-surface)] hover:bg-[var(--terminal-surface-hover)]"),children:[(0,s.jsx)("div",{className:"font-medium truncate",children:e.title||"Untitled"}),(0,s.jsx)("div",{className:"text-xs mt-1 ".concat((null==t?void 0:t.id)===e.id?"opacity-70":"text-[var(--terminal-text-muted)]"),children:new Date(e.updatedAt).toLocaleDateString()})]},e.id))})}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 hide-scrollbar",children:[null==t?void 0:t.messages.map(e=>(0,s.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"),children:(0,s.jsx)("div",{className:"max-w-[85%] rounded-2xl px-4 py-3 ".concat("user"===e.role?"message-user rounded-br-md":"message-assistant rounded-bl-md"),children:"assistant"===e.role?(0,s.jsx)("div",{className:"prose prose-invert prose-sm max-w-none",children:(0,s.jsx)(I.UG,{children:e.content})}):(0,s.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.content})})},e.id)),(r||l)&&(0,s.jsx)("div",{className:"flex justify-start",children:(0,s.jsxs)("div",{className:"max-w-[85%] message-assistant rounded-2xl rounded-bl-md px-4 py-3",children:[l&&(0,s.jsxs)("div",{className:"text-xs text-[var(--terminal-text-muted)] mb-2 flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-[var(--terminal-accent)] rounded-full animate-pulse"}),l]}),r&&(0,s.jsx)("div",{className:"prose prose-invert prose-sm max-w-none",children:(0,s.jsx)(I.UG,{children:r})})]})}),(0,s.jsx)("div",{ref:w})]}),(0,s.jsx)("div",{className:"p-4 border-t border-[var(--terminal-border)]",children:(0,s.jsxs)("div",{className:"flex items-end gap-2",children:[(0,s.jsx)("textarea",{ref:S,value:j,onChange:e=>f(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),k())},placeholder:"Message Luna...",rows:1,className:"flex-1 px-4 py-3 resize-none min-h-[48px] max-h-[120px]",style:{height:"auto"},disabled:n}),(0,s.jsx)("button",{onClick:k,disabled:!j.trim()||n,className:"p-3 bg-[var(--terminal-accent)] text-black rounded-lg disabled:opacity-50 transition-opacity",children:(0,s.jsx)(D.Z,{size:20})})]})})]})}var Z=a(2489),B=a(9227),U=a(3276),_=a(6865),W=a(1239),$=a(1094);function V(e){return null==e?"-":e>0&&e<1e-4?e.toFixed(8):e>0&&e<.01?e.toFixed(6):e>0&&e<1?e.toFixed(4):e.toFixed(2)}function H(e){let{active:t,label:a,count:i,onClick:n}=e;return(0,s.jsxs)("button",{onClick:n,className:"flex-1 py-3 text-sm font-medium transition-colors ".concat(t?"text-[var(--terminal-accent)] border-b-2 border-[var(--terminal-accent)]":"text-[var(--terminal-text-muted)] border-b border-[var(--terminal-border)]"),children:[a,void 0!==i&&i>0&&(0,s.jsx)("span",{className:"ml-1 px-1.5 py-0.5 rounded text-xs ".concat(t?"bg-[var(--terminal-accent)] text-black":"bg-[var(--terminal-surface-hover)]"),children:i})]})}function J(e){var t,a;let{trade:i,currentPrice:n,onClose:r}=e,l=i.pnlDollar>=0,c=n||i.currentPrice;return(0,s.jsxs)("div",{className:"card p-4",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-semibold ".concat("buy"===i.side?"bg-[rgba(0,214,143,0.15)] text-[var(--terminal-positive)]":"bg-[rgba(255,107,107,0.15)] text-[var(--terminal-negative)]"),children:i.side.toUpperCase()}),(0,s.jsx)("span",{className:"font-semibold text-[var(--terminal-text)]",children:i.symbol})]}),(0,s.jsx)("button",{onClick:()=>r(i.id),className:"p-1.5 text-[var(--terminal-text-muted)] hover:text-[var(--terminal-negative)] hover:bg-[var(--terminal-surface-hover)] rounded",children:(0,s.jsx)(Z.Z,{size:16})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-[var(--terminal-text-dim)] text-xs",children:"Entry"}),(0,s.jsxs)("div",{className:"font-medium",children:["$",V(i.entryPrice)]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-[var(--terminal-text-dim)] text-xs",children:"Current"}),(0,s.jsxs)("div",{className:"font-medium",children:["$",V(c)]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-[var(--terminal-text-dim)] text-xs",children:"Qty"}),(0,s.jsx)("div",{className:"font-medium",children:i.quantity})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-[var(--terminal-text-dim)] text-xs",children:"P&L"}),(0,s.jsxs)("div",{className:"font-semibold ".concat(l?"pnl-positive":"pnl-negative"),children:[l?"+":"","$",(null===(t=i.pnlDollar)||void 0===t?void 0:t.toFixed(2))||"0.00"," (",l?"+":"",(null===(a=i.pnlPercent)||void 0===a?void 0:a.toFixed(2))||"0.00","%)"]})]})]}),(i.stopLossPrice||i.takeProfitPrice)&&(0,s.jsxs)("div",{className:"mt-3 pt-3 border-t border-[var(--terminal-border)] flex gap-4 text-xs",children:[i.stopLossPrice&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-[var(--terminal-negative)]",children:"SL:"})," $",V(i.stopLossPrice)]}),i.takeProfitPrice&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-[var(--terminal-positive)]",children:"TP:"})," $",V(i.takeProfitPrice)]})]})]})}function G(e){let{signal:t,onExecute:a,onSkip:i}=e;return(0,s.jsxs)("div",{className:"card p-4",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-semibold text-[var(--terminal-text)]",children:t.symbol}),(0,s.jsxs)("div",{className:"text-xs text-[var(--terminal-text-muted)] mt-0.5",children:["Confidence: ",t.confidence,"%"]})]}),(0,s.jsxs)("span",{className:"text-lg font-mono",children:["$",V(t.price)]})]}),(0,s.jsx)("div",{className:"text-xs text-[var(--terminal-text-muted)] mb-3",children:t.reasons.slice(0,2).join(" - ")}),"pending"===t.status&&(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{type:"button",onClick:()=>a(t.id),className:"flex-1 py-3 bg-[var(--terminal-positive)] text-black rounded font-medium text-sm active:opacity-70 touch-manipulation",children:"Execute"}),(0,s.jsx)("button",{type:"button",onClick:()=>i(t.id),className:"flex-1 py-3 bg-[var(--terminal-surface-hover)] text-[var(--terminal-text)] rounded font-medium text-sm active:opacity-70 touch-manipulation",children:"Skip"})]}),"pending"!==t.status&&(0,s.jsx)("div",{className:"text-xs font-medium ".concat("executed"===t.status?"text-[var(--terminal-positive)]":"skipped"===t.status?"text-[var(--terminal-text-muted)]":"text-[var(--terminal-negative)]"),children:t.status.toUpperCase()})]})}function K(e){var t,a;let{bot:i,onToggle:n}=e,r="running"===i.status,l="error"===i.status;return(0,s.jsxs)("div",{className:"card p-4",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-semibold text-[var(--terminal-text)]",children:i.name}),(0,s.jsxs)("div",{className:"text-xs text-[var(--terminal-text-muted)]",children:[i.type.toUpperCase()," - ",i.symbol]})]}),(0,s.jsx)("button",{onClick:()=>n(i.id,r?"stopped":"running"),className:"p-2 rounded-lg transition-colors ".concat(r?"bg-[rgba(0,214,143,0.15)] text-[var(--terminal-positive)]":l?"bg-[rgba(255,107,107,0.15)] text-[var(--terminal-negative)]":"bg-[var(--terminal-surface-hover)] text-[var(--terminal-text-muted)]"),children:r?(0,s.jsx)(B.Z,{size:18}):(0,s.jsx)(U.Z,{size:18})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-[var(--terminal-text-dim)] text-xs",children:"Trades"}),(0,s.jsx)("div",{className:"font-medium",children:i.totalTrades})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-[var(--terminal-text-dim)] text-xs",children:"Win Rate"}),(0,s.jsxs)("div",{className:"font-medium",children:[(null===(t=i.winRate)||void 0===t?void 0:t.toFixed(1))||"0","%"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-[var(--terminal-text-dim)] text-xs",children:"Profit"}),(0,s.jsxs)("div",{className:"font-medium ".concat(i.totalProfit>=0?"pnl-positive":"pnl-negative"),children:["$",(null===(a=i.totalProfit)||void 0===a?void 0:a.toFixed(2))||"0.00"]})]})]}),l&&i.lastError&&(0,s.jsxs)("div",{className:"mt-2 p-2 bg-[rgba(255,107,107,0.1)] rounded text-xs text-[var(--terminal-negative)] flex items-center gap-2",children:[(0,s.jsx)(_.Z,{size:14}),i.lastError]})]})}function q(){var e,t,a;let[n,r]=(0,i.useState)("chat"),[l,c]=(0,i.useState)([]),[d,o]=(0,i.useState)([]),[m,x]=(0,i.useState)([]),[u,h]=(0,i.useState)(null),[g,p]=(0,i.useState)(!0),[b,j]=(0,i.useState)(null),[f,N]=(0,i.useState)([]),[y,w]=(0,i.useState)([]),[S,k]=(0,i.useState)([]),[T,C]=(0,i.useState)([]),[P,F]=(0,i.useState)(null),[M,R]=(0,i.useState)(null),[L,E]=(0,i.useState)(30),[O,I]=(0,i.useState)([{id:"0",role:"assistant",content:"Hey! I'm Trader Luna. Ask me about markets, trading strategies, or execute trades.",timestamp:Date.now()}]),[z,Z]=(0,i.useState)(""),[B,q]=(0,i.useState)(null),[X,Q]=(0,i.useState)(!1),Y=(0,i.useRef)(null),ee=l.map(e=>e.symbol),{prices:et}=A({symbols:ee,enabled:ee.length>0}),ea=(0,i.useCallback)(async()=>{try{let{sessionId:e}=await v.createChatSession();q(e);let t=await v.getChatMessages(e);if(t.length>0){let e=t.map((e,a)=>({id:"history-".concat(a),role:e.role,content:e.content,timestamp:Date.now()-(t.length-a)*1e3}));I(t=>[t[0],...e])}}catch(e){console.error("Failed to init trading chat session:",e)}},[]);(0,i.useEffect)(()=>{ea()},[ea]),(0,i.useEffect)(()=>{var e;null===(e=Y.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[O]);let es=async()=>{if(!z.trim()||X)return;let e={id:Date.now().toString(),role:"user",content:z.trim(),timestamp:Date.now()};I(t=>[...t,e]),Z(""),Q(!0);try{let e=B;if(!e){let{sessionId:t}=await v.createChatSession();e=t,q(e)}let t=await v.sendChatMessage(e,z),a={id:t.messageId||(Date.now()+1).toString(),role:"assistant",content:t.content,timestamp:Date.now()};I(e=>[...e,a])}catch(t){console.error("Chat error:",t);let e=t instanceof Error?t.message:"Unknown error";I(t=>[...t,{id:(Date.now()+1).toString(),role:"assistant",content:"Error: ".concat(e,". Please try again."),timestamp:Date.now()}])}finally{Q(!1)}};(0,i.useEffect)(()=>{async function e(){try{let[e,t,a,s]=await Promise.all([v.getActiveTrades().catch(()=>({openPositions:[],pendingOrders:[]})),v.getResearchSignals(20).catch(()=>[]),v.getBots().catch(()=>[]),v.getSettings().catch(()=>null)]);c(e.openPositions||[]),o(t),x(a),h(s)}catch(e){console.error("Failed to load trading data:",e)}finally{p(!1)}}e();let t=setInterval(e,3e3);return()=>clearInterval(t)},[]);let ei=async e=>{try{await v.stopTrade(e,!0),c(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Failed to close trade:",e)}},en=async e=>{try{await v.confirmSignal(e,"execute"),o(t=>t.map(t=>t.id===e?{...t,status:"executed"}:t))}catch(e){console.error("Failed to execute signal:",e)}},er=async e=>{try{await v.confirmSignal(e,"skip"),o(t=>t.map(t=>t.id===e?{...t,status:"skipped"}:t))}catch(e){console.error("Failed to skip signal:",e)}},el=async(e,t)=>{try{await v.updateBotStatus(e,t),x(a=>a.map(a=>a.id===e?{...a,status:t}:a))}catch(e){console.error("Failed to toggle bot:",e)}},ec=(0,i.useCallback)(async()=>{try{let[e,t,a,s,i,n,r]=await Promise.all([v.getAutoState().catch(()=>null),v.getAutoHistory().catch(()=>({trades:[]})),v.getSignalHistory(50).catch(()=>({signals:[]})),v.getTopCandidates().catch(()=>({candidates:[]})),v.getStrategies().catch(()=>({strategies:[]})),v.getMarketRegime().catch(()=>({regime:null})),v.getAutoSettings().catch(()=>null)]);(null==e?void 0:e.state)&&j(e.state),(null==t?void 0:t.trades)&&N(t.trades),(null==a?void 0:a.signals)&&w(a.signals),(null==s?void 0:s.candidates)&&k(s.candidates),(null==i?void 0:i.strategies)&&C(i.strategies),(null==n?void 0:n.regime)&&F(n.regime),(null==r?void 0:r.settings)&&R({strategy:r.settings.strategy,strategyMode:r.settings.strategyMode,currentStrategy:r.settings.currentStrategy,excludeTop10:r.settings.excludeTop10,excludedSymbols:r.settings.excludedSymbols,btcTrendFilter:r.settings.btcTrendFilter,btcMomentumBoost:r.settings.btcMomentumBoost,btcCorrelationSkip:r.settings.btcCorrelationSkip})}catch(e){console.error("Failed to load auto trading data:",e)}},[]);(0,i.useEffect)(()=>{if("auto"===n){let e=Date.now();ec(),E(30);let t=setInterval(()=>{let t=Math.max(0,30-Math.floor((Date.now()-e)/1e3));E(t),0===t&&(ec(),e=Date.now())},1e3),a=()=>{"visible"===document.visibilityState&&(ec(),e=Date.now())};return document.addEventListener("visibilitychange",a),()=>{clearInterval(t),document.removeEventListener("visibilitychange",a)}}},[n,ec]);let ed=async()=>{try{let e=await v.startAutoTrading();e.state&&j(e.state)}catch(e){console.error("Failed to start auto trading:",e)}},eo=async()=>{try{let e=await v.stopAutoTrading();e.state&&j(e.state)}catch(e){console.error("Failed to stop auto trading:",e)}},em=async e=>{if(M)try{let t={...M,...e};await v.updateAutoSettings(t),R(t)}catch(e){console.error("Failed to update auto settings:",e)}},ex=async e=>{await em({strategy:e})},eu=async e=>{await em({strategyMode:e})},ev=async e=>{M&&await em({[e]:!M[e]})},eh=async()=>{M&&await em({excludeTop10:!M.excludeTop10})},eg=d.filter(e=>"pending"===e.status);return g?(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"w-8 h-8 border-2 border-[var(--terminal-accent)] border-t-transparent rounded-full animate-spin"})}):(null==u?void 0:u.exchangeConnected)?(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[u.paperMode&&(0,s.jsx)("div",{className:"px-4 py-2 bg-[rgba(255,201,77,0.1)] border-b border-[var(--terminal-warning)]",children:(0,s.jsxs)("div",{className:"flex items-center gap-2 text-[var(--terminal-warning)] text-sm",children:[(0,s.jsx)("div",{className:"status-dot status-paper"}),(0,s.jsx)("span",{className:"font-medium",children:"Paper Trading Mode"})]})}),(0,s.jsxs)("div",{className:"flex border-b border-[var(--terminal-border)]",children:[(0,s.jsx)(H,{active:"chat"===n,label:"Chat",onClick:()=>r("chat")}),(0,s.jsx)(H,{active:"active"===n,label:"Active",count:l.length,onClick:()=>r("active")}),(0,s.jsx)(H,{active:"signals"===n,label:"Signals",count:eg.length,onClick:()=>r("signals")}),(0,s.jsx)(H,{active:"bots"===n,label:"Bots",count:m.filter(e=>"running"===e.status).length,onClick:()=>r("bots")}),(0,s.jsx)(H,{active:"auto"===n,label:"Auto",count:null==b?void 0:b.activePositions,onClick:()=>r("auto")})]}),"chat"===n&&(0,s.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 hide-scrollbar",children:[O.map(e=>(0,s.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"),children:(0,s.jsx)("div",{className:"max-w-[85%] rounded-2xl px-4 py-3 ".concat("user"===e.role?"bg-[var(--terminal-accent)] text-black rounded-br-md":"bg-[var(--terminal-surface)] text-[var(--terminal-text)] rounded-bl-md"),children:(0,s.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.content})})},e.id)),X&&(0,s.jsx)("div",{className:"flex justify-start",children:(0,s.jsx)("div",{className:"bg-[var(--terminal-surface)] rounded-2xl rounded-bl-md px-4 py-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-[var(--terminal-accent)] rounded-full animate-pulse"}),(0,s.jsx)("span",{className:"text-sm text-[var(--terminal-text-muted)]",children:"Thinking..."})]})})}),(0,s.jsx)("div",{ref:Y})]}),(0,s.jsx)("div",{className:"p-4 border-t border-[var(--terminal-border)]",children:(0,s.jsxs)("div",{className:"flex items-end gap-2",children:[(0,s.jsx)("input",{type:"text",value:z,onChange:e=>Z(e.target.value),onKeyDown:e=>"Enter"===e.key&&!e.shiftKey&&es(),placeholder:"Ask Trader Luna...",disabled:X,className:"flex-1 px-4 py-3 bg-[var(--terminal-surface)] border border-[var(--terminal-border)] rounded-lg text-[var(--terminal-text)] placeholder-[var(--terminal-text-muted)] text-sm"}),(0,s.jsx)("button",{onClick:es,disabled:!z.trim()||X,className:"p-3 bg-[var(--terminal-accent)] text-black rounded-lg disabled:opacity-50 transition-opacity",children:(0,s.jsx)(D.Z,{size:20})})]})})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 hide-scrollbar ".concat("chat"===n?"hidden":""),children:["active"===n&&(0,s.jsx)(s.Fragment,{children:0===l.length?(0,s.jsx)("div",{className:"text-center py-12 text-[var(--terminal-text-muted)]",children:"No active positions"}):l.map(e=>{var t;return(0,s.jsx)(J,{trade:e,currentPrice:null===(t=et.get(e.symbol))||void 0===t?void 0:t.price,onClose:ei},e.id)})}),"signals"===n&&(0,s.jsx)(s.Fragment,{children:0===eg.length&&0===d.length?(0,s.jsx)("div",{className:"text-center py-12 text-[var(--terminal-text-muted)]",children:"No signals available"}):(0,s.jsxs)(s.Fragment,{children:[eg.length>0?eg.map(e=>(0,s.jsx)(G,{signal:e,onExecute:en,onSkip:er},e.id)):(0,s.jsx)("div",{className:"text-center py-6 text-[var(--terminal-text-muted)] text-sm",children:"No pending signals - scanner is active"}),d.filter(e=>"pending"!==e.status).length>0&&(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("div",{className:"text-xs text-[var(--terminal-text-dim)] uppercase tracking-wider mb-2 px-1",children:"Recent History"}),d.filter(e=>"pending"!==e.status).slice(0,5).map(e=>(0,s.jsx)(G,{signal:e,onExecute:en,onSkip:er},e.id))]})]})}),"bots"===n&&(0,s.jsx)(s.Fragment,{children:0===m.length?(0,s.jsx)("div",{className:"text-center py-12 text-[var(--terminal-text-muted)]",children:"No trading bots configured"}):m.map(e=>(0,s.jsx)(K,{bot:e,onToggle:el},e.id))}),"auto"===n&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"card p-4 mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(W.Z,{size:24,className:(null==b?void 0:b.isRunning)?"text-[var(--terminal-accent)]":"text-[var(--terminal-text-muted)]"}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"font-semibold text-[var(--terminal-text)]",children:["Auto Trading",(0,s.jsx)("span",{className:"ml-2 text-xs text-[var(--terminal-text-muted)]",children:"BUILD_28DEC_V8"})]}),(0,s.jsx)("div",{className:"text-sm ".concat((null==b?void 0:b.isPaused)?"text-[var(--terminal-warning)]":(null==b?void 0:b.isRunning)?"text-[var(--terminal-positive)]":"text-[var(--terminal-text-muted)]"),children:(null==b?void 0:b.isPaused)?"Paused":(null==b?void 0:b.isRunning)?"Running":"Stopped"})]})]}),(0,s.jsxs)("button",{onClick:(null==b?void 0:b.isRunning)?eo:ed,className:"flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ".concat((null==b?void 0:b.isRunning)?"bg-[rgba(255,107,107,0.15)] text-[var(--terminal-negative)] hover:bg-[rgba(255,107,107,0.25)]":"bg-[var(--terminal-accent)] text-black hover:opacity-90"),children:[(null==b?void 0:b.isRunning)?(0,s.jsx)($.Z,{size:18}):(0,s.jsx)(U.Z,{size:18}),(null==b?void 0:b.isRunning)?"Stop":"Start"]})]}),(null==b?void 0:b.isPaused)&&b.pauseReason&&(0,s.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-[rgba(255,193,7,0.1)] border border-[var(--terminal-warning)] rounded-lg text-sm text-[var(--terminal-warning)]",children:[(0,s.jsx)(_.Z,{size:16}),b.pauseReason]})]}),(0,s.jsxs)("div",{className:"card p-4 mb-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"text-2xl font-bold text-[var(--terminal-text)]",children:[(null==b?void 0:b.activePositions)||0,"/3"]}),(0,s.jsx)("div",{className:"text-xs text-[var(--terminal-text-muted)]",children:"Active"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"text-2xl font-bold ".concat(((null==b?void 0:b.dailyPnlPct)||0)>=0?"pnl-positive":"pnl-negative"),children:[((null==b?void 0:b.dailyPnlPct)||0)>=0?"+":"",((null==b?void 0:b.dailyPnlPct)||0).toFixed(1),"%"]}),(0,s.jsx)("div",{className:"text-xs text-[var(--terminal-text-muted)]",children:"Today P&L"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"text-2xl font-bold text-[var(--terminal-text)]",children:[(null==b?void 0:b.winsCount)||0,"/",(null==b?void 0:b.lossesCount)||0]}),(0,s.jsx)("div",{className:"text-xs text-[var(--terminal-text-muted)]",children:"W/L"})]})]}),((null==b?void 0:b.consecutiveLosses)||0)>=2&&(0,s.jsxs)("div",{className:"mt-3 text-center text-sm text-[var(--terminal-warning)]",children:[null==b?void 0:b.consecutiveLosses," consecutive losses"]})]}),P&&P.regime&&(0,s.jsxs)("div",{className:"card p-4 mb-4",children:[(0,s.jsx)("div",{className:"text-xs text-[var(--terminal-text-dim)] uppercase tracking-wider mb-3",children:"Market Regime"}),(0,s.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat("trending"===P.regime?"bg-[rgba(0,214,143,0.15)] text-[var(--terminal-positive)]":"ranging"===P.regime?"bg-[rgba(255,193,7,0.15)] text-[var(--terminal-warning)]":"bg-[var(--terminal-surface-hover)] text-[var(--terminal-text-muted)]"),children:P.regime.toUpperCase()}),(0,s.jsxs)("span",{className:"text-sm text-[var(--terminal-text-muted)]",children:["ADX: ",(null===(e=P.adx)||void 0===e?void 0:e.toFixed(1))||"-"]})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-[var(--terminal-text-dim)] text-xs",children:"BTC Trend"}),(0,s.jsx)("div",{className:"font-medium ".concat("bullish"===P.btcTrend?"text-[var(--terminal-positive)]":"bearish"===P.btcTrend?"text-[var(--terminal-negative)]":"text-[var(--terminal-text-muted)]"),children:P.btcTrend.charAt(0).toUpperCase()+P.btcTrend.slice(1)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-[var(--terminal-text-dim)] text-xs",children:"BTC Momentum"}),(0,s.jsxs)("div",{className:"font-medium ".concat(P.btcMomentum>.3?"text-[var(--terminal-positive)]":P.btcMomentum<-.3?"text-[var(--terminal-negative)]":"text-[var(--terminal-text-muted)]"),children:[(P.btcMomentum||0)>0?"+":"",(null===(t=P.btcMomentum)||void 0===t?void 0:t.toFixed(2))||"0.00"]})]})]})]}),M&&(0,s.jsxs)("div",{className:"card p-4 mb-4",children:[(0,s.jsx)("div",{className:"text-xs text-[var(--terminal-text-dim)] uppercase tracking-wider mb-3",children:"Strategy Mode"}),(0,s.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,s.jsx)("button",{onClick:()=>eu("manual"),className:"flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-colors ".concat("manual"===M.strategyMode?"bg-[var(--terminal-accent)] text-black":"bg-[var(--terminal-surface-hover)] text-[var(--terminal-text-muted)]"),children:"Manual"}),(0,s.jsx)("button",{onClick:()=>eu("auto"),className:"flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-colors ".concat("auto"===M.strategyMode?"bg-[var(--terminal-accent)] text-black":"bg-[var(--terminal-surface-hover)] text-[var(--terminal-text-muted)]"),children:"Auto"})]}),"auto"===M.strategyMode&&P&&(0,s.jsxs)("div",{className:"p-3 bg-[var(--terminal-surface)] rounded-lg text-sm mb-4",children:[(0,s.jsx)("div",{className:"text-[var(--terminal-text-muted)] mb-1",children:"Auto-selected:"}),(0,s.jsx)("div",{className:"font-semibold text-[var(--terminal-accent)]",children:(null===(a=T.find(e=>e.id===(M.currentStrategy||M.strategy)))||void 0===a?void 0:a.meta.name)||M.currentStrategy||M.strategy}),(0,s.jsx)("div",{className:"text-xs text-[var(--terminal-text-dim)] mt-1",children:"70% regime fit + 30% win rate"})]}),(0,s.jsx)("div",{className:"space-y-2",children:T.filter(e=>e.meta).map(e=>{var t,a;let i=("auto"===M.strategyMode&&M.currentStrategy||M.strategy)===e.id,n=(null===(t=e.performance)||void 0===t?void 0:t.totalTrades)>0?(100*((null===(a=e.performance)||void 0===a?void 0:a.winRate)||0)).toFixed(0):"-";return(0,s.jsxs)("button",{onClick:()=>"manual"===M.strategyMode&&ex(e.id),disabled:"auto"===M.strategyMode,className:"w-full p-3 rounded-lg text-left transition-colors ".concat(i?"bg-[rgba(0,214,143,0.15)] border border-[var(--terminal-positive)]":"auto"===M.strategyMode?"bg-[var(--terminal-surface)] opacity-60":"bg-[var(--terminal-surface)] hover:bg-[var(--terminal-surface-hover)]"),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,s.jsxs)("span",{className:"font-medium text-[var(--terminal-text)]",children:[e.meta.name,i&&(0,s.jsx)("span",{className:"ml-2 text-[var(--terminal-positive)]",children:"*"})]}),(0,s.jsxs)("span",{className:"text-sm text-[var(--terminal-text-muted)]",children:[n,"% WR"]})]}),(0,s.jsx)("div",{className:"text-xs text-[var(--terminal-text-muted)] mb-2",children:e.meta.description}),(0,s.jsx)("div",{className:"flex gap-1",children:(e.meta.suitableRegimes||[]).map(e=>(0,s.jsx)("span",{className:"px-1.5 py-0.5 rounded text-xs ".concat((null==P?void 0:P.regime)===e?"bg-[var(--terminal-positive)] text-black font-medium":"bg-[var(--terminal-surface-hover)] text-[var(--terminal-text-dim)]"),children:e},e))})]},e.id)})})]}),M&&(0,s.jsxs)("div",{className:"card p-4 mb-4",children:[(0,s.jsx)("div",{className:"text-xs text-[var(--terminal-text-dim)] uppercase tracking-wider mb-3",children:"BTC Influence (Altcoins)"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-[var(--terminal-text)]",children:"Trend Filter"}),(0,s.jsx)("div",{className:"text-xs text-[var(--terminal-text-muted)]",children:"Skip alt longs when BTC bearish"})]}),(0,s.jsx)("button",{type:"button",onClick:()=>ev("btcTrendFilter"),className:"w-12 h-6 rounded-full transition-colors touch-manipulation ".concat(M.btcTrendFilter?"bg-[var(--terminal-positive)]":"bg-[var(--terminal-surface-hover)]"),children:(0,s.jsx)("div",{className:"w-5 h-5 rounded-full bg-white transition-transform ".concat(M.btcTrendFilter?"translate-x-6":"translate-x-0.5")})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-[var(--terminal-text)]",children:"Momentum Boost"}),(0,s.jsx)("div",{className:"text-xs text-[var(--terminal-text-muted)]",children:"Adjust size by BTC momentum"})]}),(0,s.jsx)("button",{type:"button",onClick:()=>ev("btcMomentumBoost"),className:"w-12 h-6 rounded-full transition-colors touch-manipulation ".concat(M.btcMomentumBoost?"bg-[var(--terminal-positive)]":"bg-[var(--terminal-surface-hover)]"),children:(0,s.jsx)("div",{className:"w-5 h-5 rounded-full bg-white transition-transform ".concat(M.btcMomentumBoost?"translate-x-6":"translate-x-0.5")})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-[var(--terminal-text)]",children:"Correlation Skip"}),(0,s.jsx)("div",{className:"text-xs text-[var(--terminal-text-muted)]",children:"Skip correlated alts when BTC weak"})]}),(0,s.jsx)("button",{type:"button",onClick:()=>ev("btcCorrelationSkip"),className:"w-12 h-6 rounded-full transition-colors touch-manipulation ".concat(M.btcCorrelationSkip?"bg-[var(--terminal-positive)]":"bg-[var(--terminal-surface-hover)]"),children:(0,s.jsx)("div",{className:"w-5 h-5 rounded-full bg-white transition-transform ".concat(M.btcCorrelationSkip?"translate-x-6":"translate-x-0.5")})})]})]})]}),M&&(0,s.jsxs)("div",{className:"card p-4 mb-4",children:[(0,s.jsx)("div",{className:"text-xs text-[var(--terminal-text-dim)] uppercase tracking-wider mb-3",children:"Exclusions"}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-[var(--terminal-text)]",children:"Exclude Top 10"}),(0,s.jsx)("div",{className:"text-xs text-[var(--terminal-text-muted)]",children:"Skip top 10 coins by market cap"})]}),(0,s.jsx)("button",{type:"button",onClick:eh,className:"w-12 h-6 rounded-full transition-colors touch-manipulation ".concat(M.excludeTop10?"bg-[var(--terminal-positive)]":"bg-[var(--terminal-surface-hover)]"),children:(0,s.jsx)("div",{className:"w-5 h-5 rounded-full bg-white transition-transform ".concat(M.excludeTop10?"translate-x-6":"translate-x-0.5")})})]}),M.excludedSymbols.length>0&&(0,s.jsxs)("div",{className:"mt-3 text-xs text-[var(--terminal-text-muted)]",children:["Custom: ",M.excludedSymbols.join(", ")]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs text-[var(--terminal-text-dim)] uppercase tracking-wider mb-2 px-1",children:[(0,s.jsx)("span",{children:"Top 5 Candidates"}),(0,s.jsxs)("span",{className:"text-[var(--terminal-accent)] font-mono",children:[L,"s"]})]}),(0,s.jsxs)("div",{className:"card p-3 mb-4",children:[0===S.length?(0,s.jsx)("div",{className:"text-center py-4 text-[var(--terminal-text-muted)]",children:"Loading candidates..."}):(0,s.jsx)("div",{className:"space-y-2",children:S.map((e,t)=>{var a,i;return(0,s.jsxs)("div",{className:"flex items-center justify-between py-1 border-b border-[var(--terminal-border)] last:border-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("span",{className:"text-xs text-[var(--terminal-text-dim)] w-4",children:[t+1,"."]}),(0,s.jsx)("span",{className:"font-medium text-[var(--terminal-text)]",children:e.symbol.replace("_","/")})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 text-xs",children:[(0,s.jsxs)("span",{className:e.meetsRsi?"text-[var(--terminal-positive)]":"text-[var(--terminal-text-muted)]",children:["RSI ",(null===(a=e.rsi)||void 0===a?void 0:a.toFixed(1))||"-"]}),(0,s.jsxs)("span",{className:e.meetsVolume?"text-[var(--terminal-positive)]":"text-[var(--terminal-text-muted)]",children:["Vol ",(null===(i=e.volumeRatio)||void 0===i?void 0:i.toFixed(1))||"-","x"]}),e.meetsRsi&&e.meetsVolume&&(0,s.jsx)("span",{className:"px-1.5 py-0.5 bg-[var(--terminal-positive)] text-black rounded text-xs font-medium",children:"SIGNAL"})]})]},e.symbol)})}),(0,s.jsxs)("div",{className:"text-xs text-[var(--terminal-text-dim)] mt-2 text-center",children:["Trigger: ",(()=>{switch((null==M?void 0:M.strategyMode)==="auto"?M.currentStrategy||M.strategy:null==M?void 0:M.strategy){case"trend_following":return"EMA20 > EMA50 + ADX > 25";case"mean_reversion":return"Bollinger Band + RSI extreme";case"momentum":return"Strong momentum + Volume";case"btc_correlation":return"BTC correlation aligned";default:return"RSI < 30 + Vol â‰¥ 1.5x"}})()]})]}),(0,s.jsx)("div",{className:"text-xs text-[var(--terminal-text-dim)] uppercase tracking-wider mb-2 px-1",children:"Signal History (Backtest)"}),0===y.length?(0,s.jsx)("div",{className:"text-center py-8 text-[var(--terminal-text-muted)]",children:"No signals detected yet"}):y.slice(0,10).map(e=>{var t,a,i,n;return(0,s.jsxs)("div",{className:"card p-3 mb-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-semibold text-[var(--terminal-text)]",children:e.symbol.replace("_","/")}),e.executed?(0,s.jsx)("span",{className:"text-xs px-1.5 py-0.5 bg-[var(--terminal-accent)] text-black rounded",children:"Executed"}):(0,s.jsx)("span",{className:"text-xs px-1.5 py-0.5 bg-[var(--terminal-surface)] text-[var(--terminal-text-muted)] rounded",children:e.skipReason||"Skipped"})]}),(0,s.jsx)("div",{className:"text-sm font-medium ".concat("win"===e.backtestStatus?"pnl-positive":"loss"===e.backtestStatus?"pnl-negative":"timeout"===e.backtestStatus?"text-[var(--terminal-text-muted)]":"text-[var(--terminal-warning)]"),children:"win"===e.backtestStatus?"+".concat(null===(t=e.backtestPnlPct)||void 0===t?void 0:t.toFixed(1),"%"):"loss"===e.backtestStatus?"".concat(null===(a=e.backtestPnlPct)||void 0===a?void 0:a.toFixed(1),"%"):"timeout"===e.backtestStatus?"Timeout":"Pending"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-xs text-[var(--terminal-text-muted)]",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"block text-[var(--terminal-text-dim)]",children:"Entry"}),"$",V(e.entryPrice)]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"block text-[var(--terminal-text-dim)]",children:"RSI"}),(null===(i=e.rsi)||void 0===i?void 0:i.toFixed(1))||"-"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"block text-[var(--terminal-text-dim)]",children:"Vol"}),(null===(n=e.volumeRatio)||void 0===n?void 0:n.toFixed(1))||"-","x"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-xs text-[var(--terminal-text-muted)] mt-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"block text-[var(--terminal-text-dim)]",children:"SL"}),"$",V(e.suggestedStopLoss)]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"block text-[var(--terminal-text-dim)]",children:"TP"}),"$",V(e.suggestedTakeProfit)]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"block text-[var(--terminal-text-dim)]",children:"Time"}),e.backtestDurationMinutes?"".concat(e.backtestDurationMinutes,"m"):"-"]})]}),(0,s.jsx)("div",{className:"text-xs text-[var(--terminal-text-dim)] mt-2",children:new Date(e.detectedAt).toLocaleTimeString()})]},e.id)}),(0,s.jsx)("div",{className:"text-xs text-[var(--terminal-text-dim)] uppercase tracking-wider mb-2 mt-4 px-1",children:"Today's Auto Trades"}),0===f.length?(0,s.jsx)("div",{className:"text-center py-8 text-[var(--terminal-text-muted)]",children:"No auto trades today"}):f.map(e=>{var t;return(0,s.jsx)(J,{trade:e,currentPrice:null===(t=et.get(e.symbol))||void 0===t?void 0:t.price,onClose:ei},e.id)})]})]})]}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 px-6 text-center",children:[(0,s.jsx)(_.Z,{size:48,className:"text-[var(--terminal-warning)] mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-[var(--terminal-text)] mb-2",children:"Exchange Not Connected"}),(0,s.jsx)("p",{className:"text-sm text-[var(--terminal-text-muted)]",children:"Connect your exchange in the desktop app to enable trading features."})]})}var X=a(7168),Q=a(8906),Y=a(2369),ee=a(4766),et=a(7692),ea=a(9376);function es(e){let{icon:t,label:a,value:i,onClick:n,danger:r}=e;return(0,s.jsxs)("button",{onClick:n,className:"w-full flex items-center justify-between p-4 hover:bg-[var(--terminal-surface-hover)] transition-colors ".concat(r?"text-[var(--terminal-negative)]":""),disabled:!n,children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("span",{className:r?"text-[var(--terminal-negative)]":"text-[var(--terminal-text-muted)]",children:t}),(0,s.jsx)("span",{className:r?"":"text-[var(--terminal-text)]",children:a})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[i&&(0,s.jsx)("span",{className:"text-[var(--terminal-text-muted)] text-sm",children:i}),n&&(0,s.jsx)(E.Z,{size:16,className:"text-[var(--terminal-text-dim)]"})]})]})}function ei(e){let{label:t,value:a,subValue:i}=e;return(0,s.jsxs)("div",{className:"bg-[var(--terminal-surface)] rounded-lg p-3",children:[(0,s.jsx)("div",{className:"text-xs text-[var(--terminal-text-muted)] uppercase tracking-wider mb-1",children:t}),(0,s.jsx)("div",{className:"text-lg font-semibold text-[var(--terminal-text)]",children:a}),i&&(0,s.jsx)("div",{className:"text-xs text-[var(--terminal-text-dim)] mt-0.5",children:i})]})}function en(){var e,t,a;let n=(0,ea.useRouter)(),{user:r,logout:l}=h(),[c,d]=(0,i.useState)(null),[o,m]=(0,i.useState)(null),[x,u]=(0,i.useState)(!0);(0,i.useEffect)(()=>{!async function(){try{let[e,t]=await Promise.all([v.getSettings().catch(()=>null),v.getStats(30).catch(()=>null)]);d(e),m(t)}catch(e){console.error("Failed to load settings:",e)}finally{u(!1)}}()},[]);let g=async()=>{await l(),n.replace("/login")},p=async()=>{if(c)try{let e=await v.updateSettings({paperMode:!c.paperMode});d(e)}catch(e){console.error("Failed to toggle paper mode:",e)}};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"card overflow-hidden",children:(0,s.jsxs)("div",{className:"p-4 flex items-center gap-4",children:[(0,s.jsx)("div",{className:"w-14 h-14 rounded-full bg-[var(--terminal-accent)] flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-black text-xl font-bold",children:(null==r?void 0:null===(e=r.displayName)||void 0===e?void 0:e[0])||(null==r?void 0:null===(t=r.email)||void 0===t?void 0:t[0])||"U"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"font-semibold text-[var(--terminal-text)] truncate",children:(null==r?void 0:r.displayName)||"User"}),(0,s.jsx)("div",{className:"text-sm text-[var(--terminal-text-muted)] truncate",children:null==r?void 0:r.email})]})]})}),o&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xs font-semibold text-[var(--terminal-text-muted)] uppercase tracking-wider mb-3 px-1",children:"Trading Stats (30d)"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsx)(ei,{label:"Total Trades",value:o.totalTrades}),(0,s.jsx)(ei,{label:"Win Rate",value:"".concat(o.winRate.toFixed(1),"%")}),(0,s.jsx)(ei,{label:"Total P&L",value:"$".concat(o.totalPnl.toFixed(2))}),(0,s.jsx)(ei,{label:"Avg Win",value:"$".concat(o.avgWin.toFixed(2))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xs font-semibold text-[var(--terminal-text-muted)] uppercase tracking-wider mb-3 px-1",children:"Trading"}),(0,s.jsxs)("div",{className:"card divide-y divide-[var(--terminal-border)]",children:[(0,s.jsxs)("div",{className:"p-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("span",{className:"text-[var(--terminal-text-muted)]",children:(0,s.jsx)(X.Z,{size:20})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-[var(--terminal-text)]",children:"Paper Trading"}),(0,s.jsx)("div",{className:"text-xs text-[var(--terminal-text-muted)]",children:"Simulated trading without real money"})]})]}),(0,s.jsx)("button",{onClick:p,disabled:x||!c,className:"w-12 h-7 rounded-full transition-colors relative ".concat((null==c?void 0:c.paperMode)?"bg-[var(--terminal-warning)]":"bg-[var(--terminal-surface-hover)]"),children:(0,s.jsx)("div",{className:"w-5 h-5 rounded-full bg-white absolute top-1 transition-transform ".concat((null==c?void 0:c.paperMode)?"translate-x-6":"translate-x-1")})})]}),(0,s.jsx)(es,{icon:(0,s.jsx)(Q.Z,{size:20}),label:"Exchange",value:(null==c?void 0:c.exchangeConnected)?(null===(a=c.activeExchange)||void 0===a?void 0:a.toUpperCase())||"Connected":"Not Connected"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xs font-semibold text-[var(--terminal-text-muted)] uppercase tracking-wider mb-3 px-1",children:"Account"}),(0,s.jsxs)("div",{className:"card divide-y divide-[var(--terminal-border)]",children:[(0,s.jsx)(es,{icon:(0,s.jsx)(Y.Z,{size:20}),label:"Profile",value:(null==r?void 0:r.displayName)||"Set name"}),(0,s.jsx)(es,{icon:(0,s.jsx)(ee.Z,{size:20}),label:"Notifications",value:"Enabled"}),(0,s.jsx)(es,{icon:(0,s.jsx)(et.Z,{size:20}),label:"Sign Out",onClick:g,danger:!0})]})]}),(0,s.jsxs)("div",{className:"text-center py-4",children:[(0,s.jsx)("p",{className:"text-xs text-[var(--terminal-text-dim)]",children:"Luna Mobile v1.0.0"}),(0,s.jsx)("p",{className:"text-xs text-[var(--terminal-text-dim)] mt-1",children:"Local Network Only - 10.0.0.x"})]})]})}function er(){let{isAuthenticated:e,isLoading:t,checkAuth:a}=h(),[n,r]=(0,i.useState)("overview");return((0,i.useEffect)(()=>{a()},[a]),t||!e)?(0,s.jsx)("div",{className:"h-dvh flex items-center justify-center bg-[var(--terminal-bg)]",children:(0,s.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 border-2 border-[var(--terminal-accent)] border-t-transparent rounded-full animate-spin"}),(0,s.jsx)("span",{className:"text-[var(--terminal-text-muted)] text-sm",children:"Connecting..."})]})}):(0,s.jsxs)("div",{className:"h-dvh flex flex-col bg-[var(--terminal-bg)]",children:["chat"!==n&&(0,s.jsx)("header",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--terminal-border)] bg-[var(--terminal-surface)]",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-[var(--terminal-accent)] flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-black font-bold text-sm",children:"L"})}),(0,s.jsx)("h1",{className:"text-lg font-semibold text-[var(--terminal-text)]",children:(()=>{switch(n){case"overview":return"Overview";case"chat":return"Luna Chat";case"trading":return"Trading";case"settings":return"Settings";default:return"Luna"}})()})]})}),(0,s.jsx)("main",{className:"flex-1 overflow-y-auto ".concat("chat"!==n?"p-4":""),style:{paddingBottom:"calc(64px + env(safe-area-inset-bottom))"},children:(()=>{switch(n){case"overview":default:return(0,s.jsx)(L,{});case"chat":return(0,s.jsx)(z,{});case"trading":return(0,s.jsx)(q,{});case"settings":return(0,s.jsx)(en,{})}})()}),(0,s.jsx)(w,{activeTab:n,onTabChange:e=>r(e)})]})}}},function(e){e.O(0,[529,971,117,744],function(){return e(e.s=5339)}),_N_E=e.O()}]);